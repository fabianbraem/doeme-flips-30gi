---
// Challenge 4: Honest Question
---

<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>ü§î Challenge 4: Ehrlich Antwort</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        min-height: 100vh;
        font-family: 'Comic Sans MS', 'Comic Neue', cursive;
        overflow: hidden;
      }

      .challenge-page {
        min-height: 100vh;
        background: linear-gradient(135deg, #2d1b4e 0%, #1a1a2e 50%, #16213e 100%);
        padding: 20px;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
      }

      .back-btn {
        position: fixed;
        left: 20px;
        top: 20px;
        color: #ffd700;
        text-decoration: none;
        font-size: 1rem;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
        transition: all 0.3s;
        cursor: pointer;
        z-index: 100;
      }

      .back-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .challenge-header {
        text-align: center;
        margin-top: 60px;
        margin-bottom: 20px;
      }

      h1 {
        font-size: 2.5rem;
        color: #ff9f9f;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        margin-bottom: 15px;
      }

      h2 {
        font-size: 1.3rem;
        color: #fff;
        font-weight: normal;
        max-width: 400px;
        line-height: 1.4;
      }

      /* Question Section */
      .question-section {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        max-width: 600px;
      }

      .question-text {
        font-size: clamp(2rem, 8vw, 4rem);
        color: #ffd700;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
        margin-bottom: 50px;
        text-align: center;
      }

      /* Buttons Container */
      .buttons-container {
        display: flex;
        gap: 40px;
        align-items: center;
        justify-content: center;
        position: relative;
        width: 100%;
        min-height: 150px;
      }

      /* Ja Button */
      .ja-btn {
        padding: 20px 60px;
        font-size: 2rem;
        font-family: inherit;
        font-weight: bold;
        background: linear-gradient(135deg, #4CAF50, #2E7D32);
        color: white;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 8px 30px rgba(76, 175, 80, 0.5);
      }

      .ja-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 40px rgba(76, 175, 80, 0.7);
      }

      /* Ja button hint state - grows and shakes */
      .ja-btn.hint {
        animation: jaHint 0.5s ease-in-out infinite, jaGrow 0.5s ease forwards;
      }

      @keyframes jaGrow {
        0% { transform: scale(1); }
        100% { transform: scale(1.3); }
      }

      @keyframes jaHint {
        0%, 100% { transform: scale(1.3) rotate(-2deg); }
        50% { transform: scale(1.3) rotate(2deg); }
      }

      /* N√∂√∂ Button */
      .noo-btn {
        padding: 20px 60px;
        font-size: 2rem;
        font-family: inherit;
        font-weight: bold;
        background: linear-gradient(135deg, #f44336, #c62828);
        color: white;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        transition: left 0.15s, top 0.15s, box-shadow 0.3s;
        box-shadow: 0 8px 30px rgba(244, 67, 54, 0.5);
      }

      .noo-btn:hover {
        box-shadow: 0 12px 40px rgba(244, 67, 54, 0.7);
      }

      .noo-btn.escaped {
        position: fixed;
      }

      /* Taunt message */
      .taunt {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 1.2rem;
        color: #ff9f9f;
        text-align: center;
        opacity: 0;
        transition: opacity 0.3s;
        z-index: 100;
      }

      .taunt.visible {
        opacity: 1;
      }

      /* Success Modal */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      }

      .modal-content {
        background: linear-gradient(135deg, #1a4a1a, #0d2d0d);
        padding: 50px;
        border-radius: 20px;
        text-align: center;
        border: 3px solid #00c851;
        box-shadow: 0 0 50px rgba(0, 200, 81, 0.4);
        animation: modalPop 0.5s ease-out;
      }

      @keyframes modalPop {
        0% { transform: scale(0) rotate(-10deg); opacity: 0; }
        100% { transform: scale(1) rotate(0); opacity: 1; }
      }

      .modal-content h2 {
        font-size: 3rem;
        color: #00c851;
        margin-bottom: 20px;
      }

      .modal-content p {
        font-size: 1.5rem;
        margin-bottom: 10px;
      }

      .modal-subtitle {
        color: #aaa;
        font-style: italic;
      }

      .action-btn {
        margin-top: 25px;
        padding: 15px 40px;
        font-size: 1.3rem;
        font-family: inherit;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
        background: linear-gradient(135deg, #00c851, #007E33);
        color: white;
        box-shadow: 0 5px 20px rgba(0, 200, 81, 0.4);
      }

      .action-btn:hover {
        transform: scale(1.05);
      }

      /* Completed state */
      .completed-msg {
        margin-top: 50px;
        background: rgba(0, 200, 81, 0.2);
        padding: 30px 50px;
        border-radius: 15px;
        border: 2px solid #00c851;
        text-align: center;
      }

      .completed-msg h2 {
        color: #00c851;
        font-size: 2rem;
      }

      /* Responsive */
      @media (max-width: 600px) {
        body {
          font-family: 'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif;
        }
      }

      @media (max-width: 500px) {
        h1 {
          font-size: 1.8rem;
        }

        h2 {
          font-size: 1.1rem;
        }

        .question-text {
          font-size: 2rem;
          margin-bottom: 30px;
        }

        .ja-btn, .noo-btn {
          padding: 15px 40px;
          font-size: 1.5rem;
        }

        .buttons-container {
          gap: 20px;
        }
      }

    </style>

    <!-- Global styles for dynamically created celebration elements -->
    <style is:global>
      /* Firework particle */
      .pride-firework {
        position: fixed;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        pointer-events: none;
        z-index: 1100;
        animation: prideFireworkBurst 1.5s ease-out forwards;
      }

      @keyframes prideFireworkBurst {
        0% {
          transform: translate(0, 0) scale(1);
          opacity: 1;
        }
        100% {
          transform: translate(var(--tx), var(--ty)) scale(0);
          opacity: 0;
        }
      }

      /* Rainbow emoji */
      .pride-rainbow {
        position: fixed;
        font-size: 80px;
        pointer-events: none;
        z-index: 1100;
        animation: prideRainbowFly var(--duration) linear forwards;
        filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
      }

      @keyframes prideRainbowFly {
        0% {
          transform: translate(0, 0) rotate(var(--start-rot)) scale(0.5);
          opacity: 0;
        }
        10% {
          opacity: 1;
          transform: translate(calc(var(--tx) * 0.1), calc(var(--ty) * 0.1)) rotate(var(--mid-rot)) scale(1);
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translate(var(--tx), var(--ty)) rotate(var(--end-rot)) scale(0.8);
          opacity: 0;
        }
      }

      /* Flying Diana */
      .flying-diana {
        position: fixed;
        pointer-events: none;
        z-index: 1100;
        border-radius: 50%;
        object-fit: cover;
        animation: dianaFly var(--duration) linear forwards;
        filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
      }

      @keyframes dianaFly {
        0% {
          transform: translate(0, 0) rotate(0deg) scale(0.3);
          opacity: 0;
        }
        10% {
          opacity: 1;
          transform: translate(calc(var(--tx) * 0.1), calc(var(--ty) * 0.1)) rotate(360deg) scale(1);
        }
        50% {
          transform: translate(calc(var(--tx) * 0.5), calc(var(--ty) * 0.5)) rotate(720deg) scale(1.1);
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translate(var(--tx), var(--ty)) rotate(1080deg) scale(0.5);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="challenge-page">
      <a href="/landing" class="back-btn">‚Üê Zur√ºck</a>
      
      <header class="challenge-header">
        <h1>ü§î Challenge 4</h1>
        <h2>Ihr m√ºnd nur die Fraag ehrlich beantworte!</h2>
      </header>

      <div class="question-section" id="question-section">
        <div class="question-text">Bisch g√∂√∂y?</div>
        
        <div class="buttons-container" id="buttons-container">
          <button class="ja-btn" id="ja-btn">Ja</button>
          <button class="noo-btn" id="noo-btn">N√∂√∂</button>
        </div>
      </div>

      <div class="taunt" id="taunt"></div>

      <!-- Diana Ross audio -->
      <audio id="diana-ross" src="/audio/diana-ross.mp3" preload="auto"></audio>

      <!-- Already completed message -->
      <div id="completed-msg" class="completed-msg" style="display: none;">
        <h2>‚úÖ Bereits geschafft!</h2>
        <p>Du hast diese Challenge schon bestanden.</p>
      </div>

      <!-- Success Modal -->
      <div id="success-modal" class="modal" style="display: none;">
        <div class="modal-content">
          <h2> HAH! G√ñ√ñ√ñ√ñY!!üè≥Ô∏è‚Äçüåà</h2>
          <p>Aber wenigstens ehrlich!</p>

          <button id="continue-btn" class="action-btn">üö™ Zum Trip</button>
        </div>
      </div>
    </div>

    <script>
      const jaBtn = document.getElementById('ja-btn') as HTMLButtonElement;
      const nooBtn = document.getElementById('noo-btn') as HTMLButtonElement;
      const buttonsContainer = document.getElementById('buttons-container') as HTMLElement;
      const questionSection = document.getElementById('question-section') as HTMLElement;
      const tauntEl = document.getElementById('taunt') as HTMLElement;
      const successModal = document.getElementById('success-modal') as HTMLElement;
      const continueBtn = document.getElementById('continue-btn') as HTMLButtonElement;
      const completedMsg = document.getElementById('completed-msg') as HTMLElement;

      let escapeCount = 0;
      const ESCAPE_THRESHOLD = 6; // After 6 escapes, hint the Ja button

      const taunts = [
        "Sicher? ü§î",
        "Hmmm... üßê",
        "W√ºrkli n√∂d? üòè",
        "Lol, glaubi n√∂d!",
        "Die Antwort isch offesichtlich! üòÇ",
        "Probier's nochmal... üíÖ",
        "jaaa was haha! üôÑ",
        "Eifach ehrlich sii! üåà"
      ];

      // Sound effects for button escape
      const escapeSounds = [
        '/audio/challenge2/c2-sound1.mp3',
        '/audio/challenge2/c2-sound2.mp3',
        '/audio/challenge2/c2-sound3.mp3',
        '/audio/challenge2/c2-sound4.mp3'
      ];

      // Play random escape sound
      function playEscapeSound() {
        const soundUrl = escapeSounds[Math.floor(Math.random() * escapeSounds.length)];
        const audio = new Audio(soundUrl);
        audio.volume = 0.5;
        audio.play().catch(err => console.log('Audio play failed:', err));
      }

      // Check if already completed
      if (localStorage.getItem('challenge4_complete') === 'true') {
        questionSection.style.display = 'none';
        completedMsg.style.display = 'block';
      }

      // Move the N√∂√∂ button to a random position
      function moveNooButton() {
        const padding = 100;
        const btnWidth = nooBtn.offsetWidth;
        const btnHeight = nooBtn.offsetHeight;
        
        const maxX = window.innerWidth - btnWidth - padding;
        const maxY = window.innerHeight - btnHeight - padding;
        
        const x = Math.random() * (maxX - padding) + padding;
        const y = Math.random() * (maxY - padding) + padding;
        
        nooBtn.classList.add('escaped');
        nooBtn.style.left = x + 'px';
        nooBtn.style.top = y + 'px';
      }

      // Show taunt message
      function showTaunt() {
        const message = taunts[Math.floor(Math.random() * taunts.length)];
        tauntEl.textContent = message;
        tauntEl.classList.add('visible');
        setTimeout(() => {
          tauntEl.classList.remove('visible');
        }, 1500);
      }

      // N√∂√∂ button escape on hover
      nooBtn.addEventListener('mouseenter', () => {
        if (localStorage.getItem('challenge4_complete') === 'true') return;
        
        escapeCount++;
        moveNooButton();
        showTaunt();
        playEscapeSound();
        
        // After threshold escapes, make Ja button more obvious
        if (escapeCount >= ESCAPE_THRESHOLD && !jaBtn.classList.contains('hint')) {
          jaBtn.classList.add('hint');
        }
      });

      // Touch support for mobile
      nooBtn.addEventListener('touchstart', (e) => {
        if (localStorage.getItem('challenge4_complete') === 'true') return;
        
        e.preventDefault();
        escapeCount++;
        moveNooButton();
        showTaunt();
        playEscapeSound();
        
        if (escapeCount >= ESCAPE_THRESHOLD && !jaBtn.classList.contains('hint')) {
          jaBtn.classList.add('hint');
        }
      });

      // Pride colors for fireworks
      const prideColors = [
        '#E40303', // Red
        '#FF8C00', // Orange
        '#FFED00', // Yellow
        '#008026', // Green
        '#24408E', // Blue
        '#732982'  // Purple
      ];

      const dianaRossAudio = document.getElementById('diana-ross') as HTMLAudioElement;

      // Create a single firework particle
      function createFireworkParticle(x: number, y: number) {
        const particle = document.createElement('div');
        particle.className = 'pride-firework';
        
        // Random direction
        const angle = Math.random() * Math.PI * 2;
        const distance = 80 + Math.random() * 180;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        // Random pride color
        const color = prideColors[Math.floor(Math.random() * prideColors.length)];
        
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.backgroundColor = color;
        particle.style.boxShadow = `0 0 10px ${color}, 0 0 20px ${color}`;
        particle.style.setProperty('--tx', tx + 'px');
        particle.style.setProperty('--ty', ty + 'px');
        
        document.body.appendChild(particle);
        
        // Remove after animation
        setTimeout(() => particle.remove(), 1500);
      }

      // Create a firework burst at position
      function createFireworkBurst(x: number, y: number) {
        const particleCount = 25 + Math.floor(Math.random() * 20);
        for (let i = 0; i < particleCount; i++) {
          createFireworkParticle(x, y);
        }
      }

      // Create a rainbow emoji flying across screen
      function createRainbow() {
        const rainbow = document.createElement('div');
        rainbow.className = 'pride-rainbow';
        rainbow.textContent = 'üåà';
        
        // Random start position (can start from any edge)
        const startEdge = Math.floor(Math.random() * 4); // 0=left, 1=right, 2=top, 3=bottom
        let startX: number, startY: number, endX: number, endY: number;
        
        const vw = window.innerWidth;
        const vh = window.innerHeight;
        
        switch (startEdge) {
          case 0: // Start from left
            startX = -100;
            startY = Math.random() * vh;
            endX = vw + 200;
            endY = Math.random() * vh;
            break;
          case 1: // Start from right
            startX = vw + 100;
            startY = Math.random() * vh;
            endX = -200;
            endY = Math.random() * vh;
            break;
          case 2: // Start from top
            startX = Math.random() * vw;
            startY = -100;
            endX = Math.random() * vw;
            endY = vh + 200;
            break;
          default: // Start from bottom
            startX = Math.random() * vw;
            startY = vh + 100;
            endX = Math.random() * vw;
            endY = -200;
            break;
        }
        
        // Calculate movement vector
        const tx = endX - startX;
        const ty = endY - startY;
        
        // Random rotations for spinning effect
        const startRot = Math.random() * 360;
        const midRot = startRot + (Math.random() - 0.5) * 180;
        const endRot = startRot + (Math.random() - 0.5) * 360;
        
        // Random duration
        const duration = 2 + Math.random() * 2;
        
        // Random size
        rainbow.style.fontSize = (60 + Math.random() * 60) + 'px';
        rainbow.style.left = startX + 'px';
        rainbow.style.top = startY + 'px';
        rainbow.style.setProperty('--tx', tx + 'px');
        rainbow.style.setProperty('--ty', ty + 'px');
        rainbow.style.setProperty('--start-rot', startRot + 'deg');
        rainbow.style.setProperty('--mid-rot', midRot + 'deg');
        rainbow.style.setProperty('--end-rot', endRot + 'deg');
        rainbow.style.setProperty('--duration', duration + 's');
        
        document.body.appendChild(rainbow);
        
        // Remove after animation
        setTimeout(() => rainbow.remove(), duration * 1000 + 100);
      }

      // Create a flying Diana image
      function createFlyingDiana() {
        const diana = document.createElement('img');
        diana.className = 'flying-diana';
        diana.src = '/diana.jpg';
        
        // Random size
        const size = 80 + Math.random() * 100;
        diana.style.width = size + 'px';
        diana.style.height = size + 'px';
        
        // Random start position (can start from any edge)
        const startEdge = Math.floor(Math.random() * 4);
        let startX: number, startY: number, endX: number, endY: number;
        
        const vw = window.innerWidth;
        const vh = window.innerHeight;
        
        switch (startEdge) {
          case 0: // Start from left
            startX = -150;
            startY = Math.random() * vh;
            endX = vw + 200;
            endY = Math.random() * vh;
            break;
          case 1: // Start from right
            startX = vw + 150;
            startY = Math.random() * vh;
            endX = -200;
            endY = Math.random() * vh;
            break;
          case 2: // Start from top
            startX = Math.random() * vw;
            startY = -150;
            endX = Math.random() * vw;
            endY = vh + 200;
            break;
          default: // Start from bottom
            startX = Math.random() * vw;
            startY = vh + 150;
            endX = Math.random() * vw;
            endY = -200;
            break;
        }
        
        const tx = endX - startX;
        const ty = endY - startY;
        const duration = 3 + Math.random() * 2;
        
        diana.style.left = startX + 'px';
        diana.style.top = startY + 'px';
        diana.style.setProperty('--tx', tx + 'px');
        diana.style.setProperty('--ty', ty + 'px');
        diana.style.setProperty('--duration', duration + 's');
        
        document.body.appendChild(diana);
        
        setTimeout(() => diana.remove(), duration * 1000 + 100);
      }

      // Start the pride celebration!
      let rainbowInterval: number | null = null;
      let fireworkInterval: number | null = null;
      let dianaInterval: number | null = null;
      
      function startCelebration() {
        // Play Diana Ross starting at 52 seconds
        dianaRossAudio.volume = 0.7;
        dianaRossAudio.currentTime = 52;
        dianaRossAudio.play().catch(err => console.log('Audio play failed:', err));
        
        // Spawn fireworks continuously until user skips
        fireworkInterval = setInterval(() => {
          const x = Math.random() * window.innerWidth;
          const y = Math.random() * (window.innerHeight * 0.7);
          createFireworkBurst(x, y);
        }, 150) as unknown as number;
        
        // Spawn rainbows continuously until user skips
        rainbowInterval = setInterval(() => {
          createRainbow();
        }, 250) as unknown as number;
        
        // Spawn flying Dianas continuously until user skips
        dianaInterval = setInterval(() => {
          createFlyingDiana();
        }, 600) as unknown as number;
        
        // Show modal after a delay (effects continue on top)
        setTimeout(() => {
          successModal.style.display = 'flex';
        }, 1500);
      }
      
      // Stop celebration effects
      function stopCelebration() {
        if (fireworkInterval) {
          clearInterval(fireworkInterval);
          fireworkInterval = null;
        }
        if (rainbowInterval) {
          clearInterval(rainbowInterval);
          rainbowInterval = null;
        }
        if (dianaInterval) {
          clearInterval(dianaInterval);
          dianaInterval = null;
        }
        dianaRossAudio.pause();
      }

      // Ja button wins!
      jaBtn.addEventListener('click', () => {
        if (localStorage.getItem('challenge4_complete') === 'true') return;
        
        localStorage.setItem('challenge4_complete', 'true');
        startCelebration();
      });

      // Continue button
      continueBtn.addEventListener('click', () => {
        stopCelebration();
        window.location.href = '/trips/4';
      });

      // Reposition on window resize
      window.addEventListener('resize', () => {
        if (nooBtn.classList.contains('escaped')) {
          moveNooButton();
        }
      });
    </script>
  </body>
</html>
